# M7 备份与恢复

目标
- 为库的索引与配置提供增量备份与一致性恢复，保障家庭库的可持续与可靠性。

交付内容
- 备份：索引库、配置、预览清单的增量备份；计划任务与手动触发。
- 恢复：从备份恢复，进行一致性校验（文件存在性、哈希匹配、索引关系）。
- 报告与日志：备份/恢复结果与差异报告；错误码与可诊断日志。

验收标准
- 恢复后一致性校验 100% 通过；异常文件进行隔离与报告。
- 备份作业失败率<1%；可观测指标齐全。

约束与边界
- 媒体原文件不做冗余备份（MVP），主路径为库根；索引与配置可备份到外部盘。

技术要点
- 备份元数据结构与版本；校验与比对流程；任务队列与重试策略。

风险与预案
- 外部盘不可用 → 健康检查与失败降级；提醒与重试。

执行计划与进度快照
- 当前状态：pending
- 任务清单：
  - [ ] 备份模块与计划任务
  - [ ] 恢复流程与一致性校验
  - [ ] 报告与日志

依赖与关联
- 依赖：M4（索引结构与预览清单）。

输出与交付物链接
- 代码位置：station/desktop/lib/services/backup
- 文档链接：index.zh.md，MVP-scope.zh.md