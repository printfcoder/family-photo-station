# Onboarding 首启向导（桌面端）

页面概述
- 引导用户完成库根路径选择（绝对路径）、用户创建/角色选择、设备ID/令牌生成、二维码展示或局域网发现，并确认配对成功。

里程碑与协同
- M2（桌面库初始化与配对）；与手机端 QR Scan/Discovery 双端协同。

路由与模块路径
- 路由：/onboarding
- 模块路径：station/desktop/lib/modules/onboarding

角色与权限
- 普通用户与管理员均可进行首启；管理员仅在用户创建列表中可见聚合计数，不可浏览内容。

功能列表
- 选择库根路径（绝对路径校验、可写性验证）
- 创建用户（生成 user_id，角色选择）
- 生成设备ID与短期令牌（钥匙串/安全存储）
- 展示二维码、LAN 发现辅助
- 配对确认（返回绑定的 user_id）

UI结构与元素位置
- Header：应用标题与步骤进度指示（Step 1/4）
- Step 1（欢迎）：左侧说明文本；右侧“开始”按钮
- Step 2（库根路径选择）：中部路径选择控件与校验提示；底部“下一步”
- Step 3（用户与令牌）：左侧用户列表/创建；右侧显示设备ID与令牌状态；底部“生成二维码”与“LAN 发现”
- Step 4（配对）：中心二维码（300x300）、下方配对状态；右上角“跳过发现”链接；底部“完成”

交互与流程
- pickLibraryRoot → createUser/chooseUser → issueToken → generateQr/lanDiscovery → confirmPairing

状态与空态
- 未选择路径：禁用“下一步”；路径不可写：红色错误提示
- 无用户：显示“创建用户”空态卡片

错误与提示
- 钥匙串不可用、二维码生成失败、令牌过期、LAN 发现超时（提供重试）

指标与验收
- 配对≤30秒；绝对路径持久化成功；不依赖 station/backend；管理员不可见内容

关联文档与代码
- M2 文档、ADR-0001（目录隔离）、ADR-0003（管理员受限视图）